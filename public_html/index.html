<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript">
            
            function conectar() {
                var wsUri = "ws://localhost:8080/TrucoArgento-Servidor/TrucoArgento";

                var websocket = new WebSocket(wsUri);

                websocket.onopen = function(evt) {
                    log("Conectado...");
                    var json = {
                        accion : "entraJuego",
                        nombre : nombre.value
                    };
                    websocket.send(JSON.stringify(json));
                    console.log("enviando : " + json)
                };

                websocket.onmessage = function(event) {
                    
                    var jsonData = JSON.parse(event.data);
                    
                    if (jsonData.accion === "espera") {
                        log(jsonData.mensaje);
                    }
                    
                    if (jsonData.accion === "a_jugar") {
                        //window.location = jsonData.href;
                        console.log("Te tocaron estas cartas : " + jsonData.cartas);
                    }
                    
                    
                    //log("servidor dice : " + jsonData);
                };

                websocket.onerror = function(evt) {
                    log("ojo!.. error:" + evt.data);
                };

                function log(mensaje) { //aqui mostrará el LOG de lo que está haciendo el WebSocket
                    var logDiv = document.getElementById("log");
                    logDiv.innerHTML += (mensaje + '<br/>');
                }
        }
        </script>
    </head>
    <body>
        <h1>Truco Argento</h1>
        <form >
            <label >Nombre:</label>
            <input id='nombre' name='nombre'/>
            <button type="button" onclick="conectar()">Entrar Juego</button>
        </form>
        <div id="log">
 
        </div>
    </body>
</html>